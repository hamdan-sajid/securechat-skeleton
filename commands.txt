py -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt

DB_HOST=localhost
DB_PORT=3307
DB_USER=scuser
DB_PASSWORD=scpass
DB_NAME=securechat

CA_CERT_PATH=certs/ca_cert.pem
SERVER_CERT_PATH=certs/server_cert.pem
SERVER_KEY_PATH=certs/server_key.pem
CLIENT_CERT_PATH=certs/client_cert.pem
CLIENT_KEY_PATH=certs/client_key.pem

SERVER_CN=server.local
CLIENT_CN=client.local

SERVER_HOST=localhost
SERVER_PORT=8888

# Start MySQL container (if not already running)
docker run -d --name securechat-db -e MYSQL_ROOT_PASSWORD=rootpass -e MYSQL_DATABASE=securechat -e MYSQL_USER=scuser -e MYSQL_PASSWORD=scpass -p 3307:3306 mysql:8

# Verify container is running
docker ps

# If container already exists, start it:
docker start securechat-db

# Create database tables
py -m app.storage.db --init

# Generate Root CA
py scripts/gen_ca.py --name "FAST-NU Root CA" --out certs

# Generate server certificate
py scripts/gen_cert.py --cn server.local --out server --dir certs

# Generate client certificate
py scripts/gen_cert.py --cn client.local --out client --dir certs

# Find the latest transcript and receipt files in transcripts/ folder
# Then verify:

py scripts/verify_receipt.py ^
  --transcript transcripts/transcript_<session_id>.txt ^
  --receipt transcripts/receipt_<session_id>_server.json ^
  --cert certs/server_cert.pem ^
  --message-cert certs/client_cert.pem

  py scripts/verify_receipt.py
  --transcript transcripts/transcript_127.0.0.1_6716_1763293340724.txt 
  --receipt transcripts/receipt_127.0.0.1_6716_1763293340724_server.json 
  --cert certs/server_cert.pem 
  --message-cert certs/client_cert.pem

  docker exec -it securechat-db mysql -uscuser -pscpass securechat
SHOW TABLES;
DESCRIBE users;
SELECT * FROM users;
EXIT;
